# Основная мысль : мы каждый пиксель прогоняем через градиентный спуск(все пиксели - настраиваемые параметры),а критерий качества(HC - сверточная)
#  уменьшаеться по мере того,как наше изображение больше похоже на стилизованное.

# У нас две главные метрики:
# 1. Степень соответствия преобразованного изображения исходному(обычно используюи сумму квадратов разности,но оно не учитывает форму,поэтому используем VGG-19) 
# 2. Степень стилизации преобразованного изображения 


# Как вообще работает?
# Сначала мы берем исходно изображение и прогоняем через VGG-19,после этого мы прогоняем стилизованное изображение,у каждого изображения на последнем
# фильтре получаються параметры p,i,j,k(для второго(номер фильтра и размер изображения)) и t,i,g,k(для первого) мы вычисляем разность и усредняем значения ->
# -> Мы получаем 1-ю метрику( Conv 5-2 )

# 2-я метрика (Conv 5-1):
# 1.Сначала мы берем изображение для стилизации и на предпоследнем фильтре мы вычисляем матрицу 'Грамма' - берем все фильтры изображения,конвертируем в матрицу и 
# умножаем ее саму на себя в транспонированном виде(колонки и строки меняем местами),после этого мы получаем карту признаков для этого изображения 
# 2.После этого проводим тоже самое с уже стилизованным изображением 
# 3.Вычисляем сумму квадратов разности и нормируем 
# Но этого не совсем достаточно для проверки стилизации какого-либо изображения,поэтому мы кое-что делаем еще:
# 1.То,что мы делали для второй метрики мы повторяем для начальных фильтров каждого слоя(всего 5)
# 2.После этого мы вычисляем сумму наших значений на переменную L(в рамках задачи мы просто усредняем)(Js)
# 3.Далее мы cоздаем переменную Jc,в которую просто переводим нашу первую метрику 
# 4. По итогу мы это все приводим в уравнение J = a*Jc + b*Js
# 5.Теперь мы можем получить разную степень стилизации нашего изображения 
